<!DOCTYPE html><!--MAIn Builder 05-03-25 -->
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PC Builder</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">   
    <link rel="stylesheet" href="{% static 'css/buildpc.css' %}"> 
    <title>About Us</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="icon" href="{% static 'images/favicon.ico' %}" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,900">
    <link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">
    <link rel="stylesheet" href="{% static 'css/fonts.css' %}">  
    <script src="{% static 'js/build.js' %}"></script>  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        .rd-nav-item .rd-nav-link {
      text-decoration: none !important;
  }
        .ie-panel {
            display: none;
            background: #212121;
            padding: 10px 0;
            box-shadow: 3px 3px 5px 0 rgba(0, 0, 0, .3);
            clear: both;
            text-align: center;
            position: relative;
            z-index: 1;
        }
        html.ie-10 .ie-panel,
        html.lt-ie-10 .ie-panel {
            display: block;
        }
      /* Style the button for the chatbot */
.chatbot-button {
    position: fixed;
    bottom: 10px;
    right: 100px;
    background-color: #0354e9; /* Accent color */
    color: white;
    border: none;
    padding: 15px;
    border-radius: 50%;
    font-size: 18px;
    cursor: pointer;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    z-index: 1000;
}

/* Chatbox container styling */
.chat-container {
    position: fixed;
    bottom: 80px;
    right: 20px;
    width: 350px;
    height: 450px;
    border: 1px solid #ccc;
    background-color: #fff;
    display: none; /* Initially hidden */
    flex-direction: column;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    z-index: 1000;
    border-radius: 10px;
}

/* Header of the chatbox */
.chat-container header {
    background-color: #0354e9; /* Accent color */
    color: white;
    padding: 15px;
    text-align: center;
    font-weight: bold;
    border-radius: 10px 10px 0 0;
}

/* Styling for the chat history */
.chat-history {
    max-height: 350px;
    overflow-y: auto;
    padding: 10px;
    flex-grow: 1;
}

/* Chat messages */
.message {
    margin-bottom: 10px;
}

.user-message {
    font-weight: bold;
    color: #0354e9;
}

.bot-message {
    background-color: #f1f1f1;
    padding: 10px;
    border-radius: 5px;
    color: #333;
    line-height: 1.5;
}

/* Chat input styling */
.chat-container input {
    width: calc(100% - 100px); /* Adjust input width */
    padding: 10px;
    border: none;
    border-top: 1px solid #ccc;
    font-size: 14px;
    border-radius: 0 0 10px 10px;
}

/* Send button */
.chat-container button {
    width: 80px;
    padding: 10px;
    background-color: #0354e9;
    color: white;
    border: none;
    cursor: pointer;
    border-radius: 5px;
    font-size: 14px;
    margin-top: 5px;
}


    </style>
</head>
<body>
<!--HEADER START---------------->
<div class="ie-panel"><a href="http://windows.microsoft.com/en-US/internet-explorer/"><img src="{% static 'images/ie8-panel/warning_bar_0000_us.jpg' %}" alt="Warning Bar" height="42" width="820" alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today."></a></div>
<div class="preloader">
  <div class="preloader-body">
    <div class="cssload-container">
      <div class="cssload-speeding-wheel"></div>
    </div>
    <p>Loading...</p>
  </div>
</div>
<div class="page">
<!-- Page Header-->
<header class="section page-header">
<!-- RD Navbar-->
<div class="rd-navbar-wrap">
<nav class="rd-navbar rd-navbar-wide" data-layout="rd-navbar-fixed" data-sm-layout="rd-navbar-fixed" data-md-layout="rd-navbar-fixed" data-md-device-layout="rd-navbar-fixed" data-lg-layout="rd-navbar-static" data-lg-device-layout="rd-navbar-static" data-xl-layout="rd-navbar-static" data-xl-device-layout="rd-navbar-static" data-lg-stick-up-offset="46px" data-xl-stick-up-offset="46px" data-xxl-stick-up-offset="46px" data-lg-stick-up="true" data-xl-stick-up="true" data-xxl-stick-up="true">
  <div class="rd-navbar-main-outer">
    <div class="rd-navbar-main">
      <!-- RD Navbar Panel-->
      <div class="rd-navbar-panel">
        <!-- RD Navbar Toggle-->
        <button class="rd-navbar-toggle" data-rd-navbar-toggle=".rd-navbar-nav-wrap"><span></span></button>
        <!-- RD Navbar Brand-->
        <div class="rd-navbar-brand">
          <a class="brand" href="{% url 'index' %}">
            <img class="brand-logo-dark" src="{% static 'images/logo-default-261x72.png' %}" alt="" width="261" height="72" srcset="{% static 'images/logo-default-261x72.png' %} 2x"/>
            <img class="brand-logo-light" src="{% static 'images/logo-inverse-133x45.png' %}" alt="" width="133" height="45" srcset="{% static 'images/logo-inverse-266x90.png' %} 2x"/>
          </a>
        </div>
      </div>

      <div class="rd-navbar-nav-wrap">
        <!-- RD Navbar Nav-->
        <ul class="rd-navbar-nav">
          <li class="rd-nav-item active"><a class="rd-nav-link" href="{% url 'index' %}">Home</a></li>
          <!--li class="rd-nav-item"><a class="rd-nav-link" href="{% url 'pcbuild' %}">Builder</a></li-->
          <li class="rd-nav-item"><a class="rd-nav-link" href='/parts/'>PC Parts</a></li>
          <li class="rd-nav-item"><a class="rd-nav-link" href="{% url 'build_help' %}">Build Help</a></li>
          <li class="rd-nav-item"><a class="rd-nav-link" href="{% url 'contacts' %}">Contacts</a></li>
          
          {% if user.is_authenticated %}
          <li class="rd-nav-item" style="position: relative;">
              <div class="user-info-box" style="display: flex; align-items: center; justify-content: center; cursor: pointer;" onclick="toggleDropdown()">
                  {% if request.user.profile.profile_picture %}
                      <img src="{{ request.user.profile.profile_picture.url }}" alt="Profile Picture" style="width:50px;height:50px;border-radius:50%; margin-right: 10px; margin-top: 15px;" />
                  {% else %}
                      <img src="{% static 'images/default-profile.png' %}" alt="Profile Picture" style="width:50px;height:50px;border-radius:50%; margin-right: 10px; margin-top: 15px;" />
                  {% endif %}
                  <span style="margin-top: 15px;">{{ user.username }}</span>
              </div>
              <div id="user-dropdown" class="dropdown-menu" style="display: none; position: absolute; top: 100%; right: 0; background: #fff; border: 1px solid #ddd; padding: 10px; width: 150px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);">
                  <a href="{% url 'profile' %}" class="dropdown-item">Manage Profile</a>
      
                  {% if user.is_staff %}
                      <a href="{% url 'staff_dashboard' %}" class="dropdown-item" style="color: #28a745; font-weight: bold;">Staff Panel</a>
                  {% endif %}
      
                  <form method="post" action="{% url 'logout' %}" class="dropdown-item">
                      {% csrf_token %}
                      <button type="submit" style="background: none; border: none; padding: 0; color: #007bff;">Logout</button>
                  </form>
              </div>
          </li>
      {% else %}
          <li class="rd-nav-item"><a class="rd-nav-link" href="{% url 'login' %}">Login</a></li>
          <li class="rd-nav-item"><a class="rd-nav-link" href="{% url 'signup' %}">Sign up</a></li>
      {% endif %}
      
      <script>
      function toggleDropdown() {
          var dropdown = document.getElementById("user-dropdown");
          dropdown.style.display = (dropdown.style.display === "none" || dropdown.style.display === "") ? "block" : "none";
      }
      
      // Close dropdown when clicking outside
      document.addEventListener("click", function(event) {
          var dropdown = document.getElementById("user-dropdown");
          var userInfoBox = document.querySelector(".user-info-box");
      
          if (!userInfoBox.contains(event.target) && dropdown.style.display === "block") {
              dropdown.style.display = "none";
          }
      });
      </script>
        </ul>
      </div>
    </div>
  </div>
</nav>
</div>
</header><!--HEADER END---------->
<script>
function toggleDropdown() {
var dropdown = document.getElementById("user-dropdown");
if (dropdown.style.display === "none" || dropdown.style.display === "") {
  dropdown.style.display = "block";
} else {
  dropdown.style.display = "none";
}
}
</script>

<!---Builder Section----------------------------------------------------------------------------->

    <form action="" method="POST" id="build-form">
        {% csrf_token %}
        <div class="form-group">
            <div class="input-row">
            <label for="build_name">Build Name:</label>
            <input type="text" id="build_name" name="build_name" required autocomplete="off" >
            </div>
        </div><br>
        <div class="component-grid">
        <!-- CPU Selection -->
        <!-- CPU Selection -->
        <div class="component-container">
            <div class="component-header">
                <img src="{% static 'build_ico/1.png' %}" class="component-icon">
                <label for="cpu">CPU</label>
            </div>
            <div id="cpu" class="component-box">
                <button id="cpuButton" onclick="openModal('cpuModal', event)" type="button" class="add-component-btn">Add CPU</button>
            </div>
            <input type="hidden" name="cpu" id="cpuValue" c1="socket" required>
        </div>


        <!-- Motherboard Selection -->
        <div class="component-container">
            <div class="component-header">
                <img src="{% static 'build_ico/2.png' %}" class="component-icon">
                <label for="motherboard">Motherboard</label>
            </div>
            <div id="motherboard" class="component-box">
                <button id="motherboardButton" onclick="openModal('motherboardModal', event)" type="button" class="add-component-btn">Add Motherboard</button>
            </div>
            <input type="hidden" name="motherboard" id="motherboardValue" r1="ram" required>
        </div>

        <!-- RAM Selection -->
        <div class="component-container">
            <div class="component-header">
                <img src="{% static 'build_ico/4.png' %}" class="component-icon">
                <label for="ram">RAM</label>
            </div>
            <div id="ram" class="component-box">
                <button id="ramButton" onclick="openModal('ramModal', event)" type="button" class="add-component-btn">Add RAM</button>
            </div>
            <input type="hidden" name="ram" id="ramValue">
        </div>
        

        <!-- GPU Selection -->
        <div class="component-container">
            <div class="component-header">
                <img src="{% static 'build_ico/3.png' %}" class="component-icon">
                <label for="gpu">GPU</label>
            </div>
            <div id="gpu" class="component-box">
                <button id="gpuButton" onclick="openModal('gpuModal', event)" type="button" class="add-component-btn">Add GPU</button>
            </div>
            <input type="hidden" name="gpu" id="gpuValue">
        </div>
        

        <!-- SSD Selection -->
        <div class="component-container">
            <div class="component-header">
                <img src="{% static 'build_ico/6.png' %}" class="component-icon">
                <label for="ssd">SSD</label>
            </div>
            <div id="ssd" class="component-box">
                <button id="ssdButton" onclick="openModal('ssdModal', event)" type="button" class="add-component-btn">Add SSD</button>
            </div>
            <input type="hidden" name="ssd" id="ssdValue">
        </div>

        <!-- PSU Selection -->
        <div class="component-container">
            <div class="component-header">
                <img src="{% static 'build_ico/5.png' %}" class="component-icon">
                <label for="psu">PSU</label>
            </div>
            <div id="psu" class="component-box">
                <button id="psuButton" onclick="openModal('psuModal', event)" type="button" class="add-component-btn">Add PSU</button>
            </div>
            <input type="hidden" name="psu" id="psuValue" power="0">
        </div>
        </div>
        <input type="hidden" id="totalPowerValue" name="totalPower">
        <input type="hidden" id="totalPriceValue" name="total_price" value="0">
        

        <!-- Total Price Display -->
        <!-- Total Price and Action Buttons Box -->
        <div class="total-price-box">
            <div class="total-price-container">
                <strong>Total Price: <span id="totalPrice">‚Çπ0</span></strong>
                <p>Total Wattage: 
                    <span id="totalPower">0W</span> 
                    <img src="{% static 'images/watt.png' %}" class="watt-icon">
                </p>
            </div>

            <!-- Action Buttons -->
            <div class="button-container">
                <button class="button button-build" type="submit" id="buildPcButton" disabled>Build PC</button>
                <button class="button button-print" type="button" onclick="printBuild();">Print Build</button>
                <button class="button button-purchase" type="submit" id="buildpurchase" formaction="{% url 'purchase' %}">Purchase</button>
            </div>
        </div>
    </form><br><br>
 
<center>
<!-- New button to remove all components -->
<button id="resetAllButton" class="button-removal" onclick="resetAllComponents()">Remove All Components</button><br>
</center>

<br>

<script> 

function checkFormCompletion() {
    const requiredFields = ["cpuValue", "motherboardValue", "ramValue", "gpuValue", "ssdValue", "psuValue"];
    let isComplete = requiredFields.every(id => document.getElementById(id).value.trim() !== "");

    document.getElementById("buildPcButton").disabled = !isComplete;
    document.getElementById("buildpurchase").disabled = !isComplete;
    
}

// Attach event listener to hidden inputs
document.addEventListener("DOMContentLoaded", function () {
    document.querySelectorAll("input[type='hidden']").forEach(input => {
        input.addEventListener("input", checkFormCompletion);
    });

    checkFormCompletion(); // Initial check when page loads
});

//TOTAL PRICE>>?>?
// Function to update total price dynamically
function updateTotalPrice() {
    let total = 0;

    // Loop through all selected components and sum up their prices
    document.querySelectorAll(".selected-component").forEach(component => {
        total += parseFloat(component.getAttribute("data-price")) || 0;
    });

    // Update the total price display
    document.getElementById("totalPrice").textContent = "‚Çπ" + total.toLocaleString();

    // Update the hidden input field for form submission
    document.getElementById("totalPriceValue").value = total;
}
//TOTAL PRICE>>?>?
//TOTAL POWER>?>?

function updateTotalPower() {
    let totalPower = 0;

    // Loop through all selected components (excluding PSU) and sum up their power consumption
    document.querySelectorAll(".selected-component").forEach(component => {
        if (!component.id.includes("psu")) { // ‚úÖ Exclude PSU from total power calculation
            totalPower += parseFloat(component.getAttribute("data-watt")) || 0;
        }
    });

    // Update the total power display
    document.getElementById("totalPower").textContent = totalPower + "W";
    document.getElementById("totalPowerValue").value = totalPower;

    // ‚úÖ Re-filter PSU options whenever power updates
    filterPSUs();
}




document.addEventListener("DOMContentLoaded", function () {

function openModal(modalId) {
    if (event) event.preventDefault();
    // üö® Prevent PSU Selection Until All Other Components Are Chosen
    if (modalId === 'psuModal') {
    let requiredComponents = ["cpuValue", "motherboardValue", "ramValue", "gpuValue"]; // Add required components
    let allSelected = requiredComponents.every(id => document.getElementById(id).value.trim() !== "");

    if (!allSelected) {
            alert("‚ö†Ô∏è Please select all other components before choosing a PSU.");
        return; // Stop execution if components are missing
    }
    }

    document.body.style.overflow = "hidden"; // Disable scrolling
    document.getElementById(modalId).style.display = "flex";
    updateTotalPower();
    // Apply filters dynamically
    if (modalId === 'motherboardModal') {
        filterMotherboards();  
    }
    if (modalId === 'ramModal') {
        filterRams();
    }
    if (modalId === 'psuModal') {
        filterPSUs();
    }
    // Apply filters dynamically
    if (modalId === 'motherboardModal') filterMotherboards();
    if (modalId === 'ramModal') filterRams();
    if (modalId === 'psuModal') filterPSUs();  // Ensure PSU filtering works

    
}

function closeModal(modalId) {
    document.getElementById(modalId).style.display = "none";
    document.body.style.overflow = ""; // Enable scrolling again
}

function selectComponent(componentType, componentData) {
    console.log("Selected component:", componentData);

    let buttonContainer = document.querySelector(`#${componentType}`);
    let inputField = document.querySelector(`#${componentType}Value`);

    if (!buttonContainer || !inputField) return;

    // Store relevant attributes in hidden fields
    if (componentType === "cpu") {
        inputField.setAttribute('c1', componentData.CPU_socket || "N/A");  
    } 
    if (componentType === "motherboard") {
        inputField.setAttribute('r1', componentData.RAM_Type || "N/A");  
        filterRams();
    }
    if (componentType === "psu") {
        inputField.setAttribute('power', componentData.watt || "N/A"); 
        buttonContainer.setAttribute("data-watt", 0); // ‚úÖ Prevent PSU from adding to total power
    } else {
        buttonContainer.setAttribute("data-watt", componentData.watt || 0);
    }

    // Update UI
    updateComponentUI(componentType, buttonContainer, componentData);

    inputField.value = componentData.id;
    buttonContainer.setAttribute("data-price", componentData.price);
    buttonContainer.setAttribute("data-watt", componentData.watt || 0);
    buttonContainer.classList.add("selected-component");

    updateTotalPrice();
    updateTotalPower(); // Update total power
    checkFormCompletion();
    closeModal(componentType + "Modal");
}

function updateComponentUI(componentType, container, data) {
    container.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 8px; background: #f9f9f9;">
            <div style="display: flex; align-items: center; gap: 15px;">
                <img src="${data.imageUrl}" alt="${data.name}" style="width: 70px; height: 70px; object-fit: contain;">
                <span style="font-size: 16px; font-weight: bold;">${data.brand} ${data.name}<span style="font-size: 16px; color: #007bff; align-items: center">‚Çπ${data.price}</span><br><a href="/component/${data.model}" target="_blank" style="color: #ff0000; text-decoration: none;">[More info]</a></span><br>
                
            </div>
            <div>
                <button class="edit-btn" onclick="openModal('${componentType}Modal'); event.stopPropagation();" style="padding: 6px 12px; font-size: 14px; background: #ffc107; color: #333; border: none; border-radius: 5px; cursor: pointer; margin-right: 5px;">Edit</button>
                <button class="delete-btn" onclick="resetComponent('${componentType}'); event.stopPropagation();" style="padding: 6px 12px; font-size: 14px; background: #dc3545; color: white; border: none; border-radius: 5px; cursor: pointer;">Delete</button>
            </div>
        </div>  
    `;
}

    function resetComponent(componentType) {
        if (event) {
        event.preventDefault();  
        event.stopPropagation();
        }
        if (event) event.preventDefault(); // Prevent form submission
        event.stopPropagation();
        let buttonContainer = document.querySelector(`#${componentType}`);
        let inputField = document.querySelector(`#${componentType}Value`);

        if (buttonContainer && inputField) {
            buttonContainer.innerHTML = `<button id="${componentType}Button" onclick="openModal('${componentType}Modal')" type="button" class="add-component-btn">Add ${componentType}</button>`;
            inputField.value = ""; // Clear stored value
            buttonContainer.removeAttribute("data-price");
            buttonContainer.removeAttribute("data-watt");
            buttonContainer.classList.remove("selected-component");
            if (componentType === "psu") {
            inputField.removeAttribute("power"); // ‚úÖ Clear PSU-specific data
        }
            updateTotalPrice(); // Update total price
            updateTotalPower();  // Update total power
            checkFormCompletion(); // Check again when a component is removed
        }
            return false; // Prevent reload
    }
    // Function to reset all components at once
    // Function to reset all components at once
    function resetAllComponents() {
        event.preventDefault();
        event.stopPropagation();

        let componentTypes = ["cpu", "gpu", "ram", "ssd", "motherboard", "psu"]; // Add all your component IDs here

        componentTypes.forEach(component => {
            resetComponent(component);
        });
        console.log("All components have been reset!");
    }
            // Adding event listener to resetAllButton in case onclick isn't working
        document.getElementById("resetAllButton").addEventListener("click", function(event) {
            resetAllComponents();
        });

    // Compatibility Logic
    function filterMotherboards() {
    const motherboardList = document.getElementById("mbList");
    if (!motherboardList) {
        console.error("Error: #mbList not found in the DOM.");
        return;
    }

    const selectedCPUSocket = document.getElementById("cpuValue").getAttribute("c1");
    const motherboardItems = motherboardList.querySelectorAll(".item");

    if (!selectedCPUSocket) {
        console.log("No CPU socket selected. Returning...");
        return;
    }

    let hasMatches = false;

    motherboardItems.forEach((item) => {
        const mbSocket = item.getAttribute("data-socket");
        const shouldShow = mbSocket === selectedCPUSocket;

        if (shouldShow) {
            item.style.display = "flex"; // Show compatible items
            hasMatches = true;
        } else {
            item.style.display = "none"; // Hide incompatible items
        }
    });

    //  Keep motherboard list visible no matter what
    motherboardList.style.display = "block";

    //  Show or remove "No Compatible Motherboards" message
    let message = document.getElementById("noMbMessage");
    
    if (!hasMatches) {
        if (!message) {
            message = document.createElement("p");
            message.id = "noMbMessage";
            message.style.padding = "10px";
            message.style.textAlign = "center";
            message.innerText = "No compatible motherboards found.";
            motherboardList.appendChild(message);
        }
    } else {
        if (message) message.remove();
    }
}



function filterRams() {
    const ramList = document.getElementById("ramList");
    if (!ramList) {
        console.error("Error: #ramList not found in the DOM.");
        return;
    }

    const selectedMBRamType = document.getElementById("motherboardValue").getAttribute("r1");
    const ramItems = ramList.querySelectorAll(".item");

    console.log("Motherboard RAM Type (r1):", selectedMBRamType);

    if (!selectedMBRamType) {
        console.log("No RAM type selected. Returning...");
        return;
    }

    let hasMatches = false;

    ramItems.forEach((item) => {
        const ramType = item.getAttribute("data-type");
        console.log("Item RAM Type:", ramType, "Selected MB RAM Type:", selectedMBRamType);

        if (ramType === selectedMBRamType) {
            item.style.display = "flex"; // Show compatible RAM
            hasMatches = true;
        } else {
            item.style.display = "none"; // Hide incompatible RAM
        }
    });

    // ‚úÖ Keep RAM list always visible
    ramList.style.display = "block";

    // ‚úÖ Show or remove "No Compatible RAM Found" message
    let message = document.getElementById("noRamMessage");

    if (!hasMatches) {
        if (!message) {
            message = document.createElement("p");
            message.id = "noRamMessage";
            message.style.padding = "10px";
            message.style.textAlign = "center";
            message.innerText = "No compatible RAM found.";
            ramList.appendChild(message);
        }
    } else {
        if (message) message.remove();
    }
}
function filterPSUs() {
    const psuList = document.getElementById("psuList");
    if (!psuList) {
        console.error("Error: #psuList not found in the DOM.");
        return;
    }

    const totalPower = parseFloat(document.getElementById("totalPowerValue").value) || 0;
    console.log("Total Power Required:", totalPower);

    const psuItems = psuList.querySelectorAll(".item");

    if (!totalPower) {
        console.log("No total power calculated yet. Returning...");
        return;
    }

    let hasMatches = false;

    psuItems.forEach((item) => {
        const psuWattage = parseFloat(item.getAttribute("data-watt")) || 0;
        console.log("Checking PSU Wattage:", psuWattage);

        const shouldShow = psuWattage >= (totalPower + 100);

        if (shouldShow) {
            item.style.display = "flex"; // ‚úÖ Show compatible PSU
            hasMatches = true;
        } else {
            item.style.display = "none"; // ‚úÖ Hide incompatible PSU
        }
    });

    // ‚úÖ Keep PSU list always visible
    psuList.style.display = "block";

    // ‚úÖ Show or remove "No Compatible PSU Found" message
    let message = document.getElementById("noPsuMessage");

    if (!hasMatches) {
        if (!message) {
            message = document.createElement("p");
            message.id = "noPsuMessage";
            message.style.padding = "10px";
            message.style.textAlign = "center";
            message.innerText = "No compatible PSU found.";
            psuList.appendChild(message);
        }
    } else {
        if (message) message.remove();
    }
}





    window.openModal = openModal;
    window.closeModal = closeModal;
    window.selectComponent = selectComponent;
    window.resetComponent = resetComponent;
    window.filterMotherboards = filterMotherboards;
    window.filterRams = filterRams;
    window.filterPSUs = filterPSUs; 
});
function filterList(component) {
    let input = document.getElementById(component + "Search").value.toLowerCase();
    let items = document.querySelectorAll("#" + component + "List .item");

    items.forEach(item => {
        let itemName = item.dataset.name.toLowerCase();
        filterRams();
        filterMotherboards();
        if (itemName.includes(input)) {
            item.style.display = "";
        } else {
            item.style.display = "none";
        }
    });
}
///FOR START RATING!!

document.addEventListener("DOMContentLoaded", function () {
                                // Select all elements with the 'rating' class
                                let ratingElements = document.querySelectorAll(".rating");

                                ratingElements.forEach(function (element) {
                                let rating = parseInt(element.getAttribute("data-rating"), 10) || 0; // Convert to integer
                                let stars = '‚≠ê'.repeat(rating); // Generate stars
                                element.textContent = stars; // Set stars inside the span
                                });
                            });

</script>

<!--Overlay) -->
<!-- CPU Selection Modal -->
<div id="cpuModal" class="modal-overlay" style="display: none;">
    <button class="close-btn" onclick="closeModal('cpuModal')">‚ùå</button>
    <div class="modal-content">        
        <input type="text" class="search-bar" id="cpuSearch" placeholder="Search CPU..." oninput="filterList('cpu')">
        <div id="cpuList">
            {% for cpu in cpus %}
            <div class="item" data-name="{{ cpu.name }}" data-socket="{{ cpu.CPU_socket }}" style="display: flex; align-items: center; gap: 15px; padding: 10px; border-bottom: 1px solid #ddd;">
                <img src="{{ cpu.image.url }}" alt="{{ cpu.name }}" class="overlay_item_images">
                <div style="flex-grow: 1;">
                    <span class="cpu-name" style="font-weight: bold; display: block;">{{ cpu.brand }}&nbsp;{{ cpu.name }}</span>                    
                    <p>User Rating: <span class="rating" data-rating="{{ cpu.rating }}"></span></p>                 
                    <p class="cpu-description" style="margin: 5px 0; color: #555;">{{ cpu.description }}</p>
                    <span class="cpu-price" style="font-size: 16px; color: #333;">‚Çπ{{ cpu.price }}</span>
                </div>
                <button class="select-btn" 
    onclick="selectComponent('cpu', {
        id: '{{ cpu.id }}',
        imageUrl: '{{ cpu.image.url }}',
        name: '{{ cpu.name }}',
        price: '{{ cpu.price }}',
        model: '{{ cpu.model }}',
        CPU_socket: '{{ cpu.CPU_socket }}',
        brand: '{{ cpu.brand }}', product_link: '{{ cpu.product_link }}',
        watt: '{{ cpu.watt }}'
    })"
    style="padding: 8px 12px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
    Select
</button>

            </div>
            {% endfor %}
        </div>  
    </div>
</div>

<!-- Motherboard Selection Modal zz-->
<div id="motherboardModal" class="modal-overlay" style="display: none;">
    <button class="close-btn" onclick="closeModal('motherboardModal')">‚ùå</button>
    <div class="modal-content">
        <input type="text" class="search-bar" id="mbSearch" placeholder="Search Motherboard..." oninput="filterList('mb')">
        <div id="mbList">
            {% for mb in motherboards %}
            <div class="item" data-name="{{ mb.name }}" data-socket="{{ mb.socket_type }}" style="display: flex; align-items: center; gap: 15px; padding: 10px; border-bottom: 1px solid #ddd;">
                <img src="{{ mb.image.url }}" alt="{{ mb.name }}" class="overlay_item_images">
                <div style="flex-grow: 1;">
                    <span class="mb-name" style="font-weight: bold; display: block;">{{ mb.brand }}&nbsp;{{ mb.name }}</span>
                    <p>User Rating: <span class="rating" data-rating="{{ mb.rating }}"></span></p>
                    <p class="mb-description" style="margin: 5px 0; color: #555;">{{ mb.description }}</p>
                    <span class="mb-price" style="font-size: 16px; color: #333;">‚Çπ{{ mb.price }}</span>
                </div>
                <button class="select-btn" 
    onclick="selectComponent('motherboard', {
        id: '{{ mb.id }}',
        imageUrl: '{{ mb.image.url }}',
        name: '{{ mb.name }}',
        price: '{{ mb.price }}',
        model: '{{ mb.model }}',
        socket_type: '{{ mb.socket_type }}',
        RAM_Type: '{{ mb.RAM_Type }}',product_link: '{{ mb.product_link }}',
        brand: '{{ mb.brand }}', watt: '{{ mb.watt }}'

    })"
    style="padding: 8px 12px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
    Select
</button>

            </div>
            {% endfor %}
        </div>  
    </div>
</div>


<!-- RAM Selection Modal -->
<div id="ramModal" class="modal-overlay" style="display: none;">
    <button class="close-btn" onclick="closeModal('ramModal')">‚ùå</button>
    <div class="modal-content">
        <input type="text" class="search-bar" id="ramSearch" placeholder="Search RAM..." oninput="filterList('ram')">
        <div id="ramList">
            {% for ram in rams %}
            <div class="item" data-name="{{ ram.name }}" data-type="{{ ram.type }}" 
                 style="display: flex; align-items: center; gap: 15px; padding: 10px; border-bottom: 1px solid #ddd;">
                <img src="{{ ram.image.url }}" alt="{{ ram.name }}" class="overlay_item_images">
                <div style="flex-grow: 1;">
                    <span class="ram-name" style="font-weight: bold; display: block;">{{ ram.brand }}&nbsp;{{ ram.name }}</span>
                    <p>User Rating: <span class="rating" data-rating="{{ ram.rating }}"></span></p>
                    <p class="ram-description" style="margin: 5px 0; color: #555;">{{ ram.description }}</p>
                    <span class="ram-price" style="font-size: 16px; color: #333;">‚Çπ{{ ram.price }}</span>
                </div>
                <button class="select-btn" 
    onclick="selectComponent('ram', {
        id: '{{ ram.id }}',
        imageUrl: '{{ ram.image.url }}',
        name: '{{ ram.name }}',
        price: '{{ ram.price }}',
        model: '{{ ram.model }}',
        type: '{{ ram.type }}',product_link: '{{ ram.product_link }}',
        brand: '{{ ram.brand }}', watt: '{{ ram.watt }}'
    })"
    style="padding: 8px 12px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
    Select
</button>

            </div>
            {% endfor %}
        </div>  
    </div>
</div>

  
<!-- GPU Selection Modal -->
<div id="gpuModal" class="modal-overlay" style="display: none;">
    <button class="close-btn" onclick="closeModal('gpuModal')">‚ùå</button>
    <div class="modal-content">
        <input type="text" class="search-bar" id="gpuSearch" placeholder="Search GPU..." oninput="filterList('gpu')">
        <div id="gpuList">
            {% for gpu in gpus %}
            <div class="item" data-name="{{ gpu.name }}" 
                 style="display: flex; align-items: center; gap: 15px; padding: 10px; border-bottom: 1px solid #ddd;">
                <img src="{{ gpu.image.url }}" alt="{{ gpu.name }}" class="overlay_item_images">
                <div style="flex-grow: 1;">
                    <span class="gpu-name" style="font-weight: bold; display: block;">{{ gpu.oem }}&nbsp;{{ gpu.brand }}&nbsp;{{ gpu.name }}</span>
                    <p>User Rating: <span class="rating" data-rating="{{ gpu.rating }}"></span></p>
                    <!--p class="gpu-description" style="margin: 5px 0; color: #555;">{{ gpu.description }}</p-->
                    <span class="gpu-price" style="font-size: 16px; color: #333;">‚Çπ{{ gpu.price }}</span>
                </div>
                <button class="select-btn" 
                onclick="selectComponent('gpu', {
                    id: '{{ gpu.id }}',
                    imageUrl: '{{ gpu.image.url }}',
                    name: '{{ gpu.name }}',
                    price: '{{ gpu.price }}',
                    model: '{{ gpu.model }}',product_link: '{{ gpu.product_link }}',
                    brand: '{{ gpu.brand }}', watt: '{{ gpu.watt }}'
                })"
                style="padding: 8px 12px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
                Select
            </button>
            
            </div>
            {% endfor %}
        </div>  
    </div>
</div>


<!-- PSU Selection Modal -->
<div id="psuModal" class="modal-overlay" style="display: none;">
    <button class="close-btn" onclick="closeModal('psuModal')">‚ùå</button>
    <div class="modal-content">
        <input type="text" class="search-bar" id="psuSearch" placeholder="Search PSU..." oninput="filterList('psu')">
        <div id="psuList">
            {% for psu in psus %}
            <div class="item" data-name="{{ psu.name }}"  data-watt="{{ psu.watt }}"
                 style="display: flex; align-items: center; gap: 15px; padding: 10px; border-bottom: 1px solid #ddd;">
                <img src="{{ psu.image.url }}" alt="{{ psu.name }}" 
                     class="overlay_item_images">
                <div style="flex-grow: 1;">
                    <span class="psu-name" style="font-weight: bold; display: block;">{{ psu.brand }}&nbsp;{{ psu.name }}</span>
                    <p>User Rating: <span class="rating" data-rating="{{ psu.rating }}"></span></p>
                    <p class="psu-description" style="margin: 5px 0; color: #555;">{{ psu.description }}</p>
                    <span class="psu-price" style="font-size: 16px; color: #333;">‚Çπ{{ psu.price }}</span>
                </div>
                <button class="select-btn" 
                onclick="selectComponent('psu', {
                    id: '{{ psu.id }}',
                    imageUrl: '{{ psu.image.url }}',
                    name: '{{ psu.name }}',
                    price: '{{ psu.price }}',
                    model: '{{ psu.model }}',product_link: '{{ psu.product_link }}',
                    brand: '{{ psu.brand }}', watt: '{{ psu.watt }}'
                })"
                style="padding: 8px 12px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
                Select
            </button>
            
            </div>
            {% endfor %}
        </div>  
    </div>
</div>


<!-- SSD Selection Modal -->
<div id="ssdModal" class="modal-overlay" style="display: none;">
    <button class="close-btn" onclick="closeModal('ssdModal')">‚ùå</button>
    <div class="modal-content">
        <input type="text" class="search-bar" id="ssdSearch" placeholder="Search SSD..." oninput="filterList('ssd')">
        <div id="ssdList">
            {% for ssd in ssds %}
            <div class="item" data-name="{{ ssd.name }}" 
                 style="display: flex; align-items: center; gap: 15px; padding: 10px; border-bottom: 1px solid #ddd;">
                <img src="{{ ssd.image.url }}" alt="{{ ssd.name }}" 
                     class="overlay_item_images">
                <div style="flex-grow: 1;">
                    <span class="ssd-name" style="font-weight: bold; display: block;">{{ ssd.brand }}&nbsp;{{ ssd.name }}</span>
                    <p>User Rating: <span class="rating" data-rating="{{ ssd.rating }}"></span></p>
                    <p class="ssd-description" style="margin: 5px 0; color: #555;">{{ ssd.description }}</p>
                    <span class="ssd-price" style="font-size: 16px; color: #333;">‚Çπ{{ ssd.price }}</span>
                </div>
                <button class="select-btn" 
                onclick="selectComponent('ssd', {
                    id: '{{ ssd.id }}',
                    imageUrl: '{{ ssd.image.url }}',
                    name: '{{ ssd.name }}',
                    price: '{{ ssd.price }}',
                    model: '{{ ssd.model }}',
                    brand: '{{ ssd.brand }}',product_link: '{{ ssd.product_link }}',
                    watt: '{{ ssd.watt }}', details_link: '{{ ssd.details_link}}'
                })"
                style="padding: 8px 12px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
                Select
            </button>
            
            </div>
            {% endfor %}
        </div>  
    </div>
</div>


<!--Overlay END------->


<!-- Chatbot button -->
<button class="chatbot-button" onclick="toggleChatbox()">Chatbot </button>

<!-- Chatbox container -->
<div class="chat-container" id="chat-container" style="display: none;">
    <header>
        <p>PC Builder AI Assistant</p>
    </header>
    <div class="chat-history" id="chat-history">
        <!-- Chat history will appear here -->
    </div>
    <form id="chat-form">
        <input type="text" id="user-input" name="user_input" placeholder="Type your message here" />
        <button type="submit">Send</button>
    </form>
</div>

<script>
  
    // Toggle the chatbox visibility when the chatbot button is clicked
    const username = "{{ user.username }}";
    function toggleChatbox() {
        const chatContainer = document.getElementById('chat-container');
        chatContainer.style.display = (chatContainer.style.display === 'none' || chatContainer.style.display === '') ? 'block' : 'none';
    }

    // Handle form submission and send data to the server
    document.getElementById('chat-form').addEventListener('submit', function(event) {
        event.preventDefault();
        const userInput = document.getElementById('user-input').value;
        fetch("{% url 'chatbot' %}", {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
                'X-CSRFToken': '{{ csrf_token }}'
            },
            body: new URLSearchParams({
                'user_input': userInput
            })
        })
        .then(response => response.json())
        .then(data => {
            const chatHistory = document.getElementById('chat-history');
            chatHistory.innerHTML += `
                <div class="message user-message">
                     <p><span style="color: red;">${username}</span>: ${data.user_input}</p>
                </div>
                <div class="message bot-message">
                    <p><strong>PC Picker:</strong></p>
                    <p>${data.ai_response}</p>
                </div>
            `;
            document.getElementById('user-input').value = '';
            chatHistory.scrollTop = chatHistory.scrollHeight; // Scroll to the latest message
        });
    });
</script>

 <!-- Page Footer START-->
      <!-- Page Footer-->
      <div class="pre-footer-classic bg-gray-700 context-dark">
        <div class="container">
          <div class="row row-30 justify-content-lg-between">
            <div class="col-sm-6 col-lg-3 col-xl-3">
              <h5>Location</h5>
              <ul class="list list-sm">
                <li>
                  <p>Thrissur</p>
                </li>
                <li>
                  <p>Kerala</p>
                </li>
                <li>
                  <p>680 501</p>
                </li>
                <li>
                  <p>India</p>
                </li>
              </ul>
            </div>
            <div class="col-sm-6 col-lg-4 col-xl-3">
              <h5>Contacts</h5>
              <dl class="list-terms-custom">
                <dt>Ph.</dt>
                <dd><a class="link-default" href="tel:#">04885 296929</a></dd>
              </dl>
              <dl class="list-terms-custom">
                <dt>Mail.</dt>
                <dd><a class="link-default" href="mailto:#">iamalwinkj@gmail.com</a></dd>
              </dl>
              <ul class="list-inline list-inline-sm">
                <li><a class="icon icon-sm icon-gray-filled icon-circle mdi mdi-facebook" href="https://www.facebook.com/SoulRavanger/"></a></li>
                <li><a class="icon icon-sm icon-gray-filled icon-circle mdi mdi-instagram" href="https://www.instagram.com/soul_ravager/"></a></li>
                <li><a class="icon icon-sm icon-gray-filled icon-circle mdi mdi-behance" href="https://x.com/Soul_Ravager"></a></li>
                <li><a class="icon icon-sm icon-gray-filled icon-circle mdi mdi-twitter" href="https://x.com/Soul_Ravager"></a></li>
              </ul>
            </div>
            <div class="col-sm-6 col-lg-4 col-xl-3">
                <h5>Newsletter</h5>
                <form class="rd-form rd-mailform" id="newsletter-form">
                    <div class="form-wrap form-wrap-icon">
                        <div class="form-icon mdi mdi-email-outline"></div>
                        <input class="form-input" id="footer-email" type="email" name="email" required>
                        <label class="form-label" for="footer-email">E-mail</label>
                    </div>
                    <div class="button-wrap">
                        <button class="button button-default button-invariable" type="submit">Subscribe</button>
                    </div>
                </form>
                <script>
                document.getElementById("newsletter-form").addEventListener("submit", function(event) {
                    event.preventDefault();
                    
                    let formData = new FormData(this);
                
                    fetch("/newsletter-subscribe/", {  // Make sure this URL matches your Django URLs
                        method: "POST",
                        body: formData
                    })
                    .then(response => response.json())
                    .then(data => {
                        alert(data.message);
                    })
                    .catch(error => console.error("Error:", error));
                });
                </script>
            </div>
            
          </div>
        </div>
      </div>
      <footer class="section footer-classic context-dark text-center">
        <div class="container">
          <div class="row row-15 justify-content-lg-between">
            <div class="col-lg-6 col-xl-6 text-lg-left">
              <p class="rights"><span>&copy;&nbsp;</span><span class="copyright-year"></span>. All Rights Reserved. Design by <a href="https://www.facebook.com/SoulRavanger/">Alwin</a></p>
            </div>
            <div class="col-lg-6 col-xl-6">
              <ul class="list-inline list-inline-lg text-uppercase">
                <li><a href="http://alvispcpicker.local/about_us/">About us</a></li>
                <li><a href="#">Our Team</a></li>
                <li><a href="#">Blog</a></li>
              </ul>
            </div>
          </div>
        </div>
      </footer>
    </div>
    <div class="snackbars" id="form-output-global"></div>
<script src="{% static 'js/core.min.js' %}"></script>
<script src="{% static 'js/script.js' %}"></script>
<!-- END PAGE FOOTER-->
</body>